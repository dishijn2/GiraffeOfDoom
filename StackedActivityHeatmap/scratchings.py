testdata = [
["2017-01-19 21:58","-28.521"],
["2017-01-19 21:59","-27.42"],
["2017-01-19 22:00","-27.305"],
["2017-01-19 22:01","-27.245"],
["2017-01-19 22:02","-27.264"],
["2017-01-19 22:03","-27.269"],
["2017-01-19 22:04","-27.174"],
["2017-01-19 22:05","-27.173"],
["2017-01-19 22:06","-27.174"],
["2017-01-19 22:07","-27.226"],
["2017-01-19 22:08","-27.327"],
["2017-01-19 22:09","-27.356"],
["2017-01-19 22:10","-27.274"],
["2017-01-19 22:11","-27.247"],
["2017-01-19 22:12","-27.114"],
["2017-01-19 22:13","-27.059"],
["2017-01-19 22:14","-27.114"],
["2017-01-19 22:15","-27.095"],
["2017-01-19 22:16","-27.097"],
["2017-01-19 22:17","-27.12"],
["2017-01-19 22:18","-27.069"],
["2017-01-19 22:19","-27.131"],
["2017-01-19 22:20","-27.167"],
["2017-01-19 22:21","-27.13"],
["2017-01-19 22:22","-27.794"],
["2017-01-19 22:23","-28"],
["2017-01-19 22:24","-27.72"],
["2017-01-19 22:25","-26.843"],
["2017-01-19 22:26","-26.744"],
["2017-01-19 22:27","-26.66"],
["2017-01-19 22:28","-26.687"],
["2017-01-19 22:29","-26.644"],
["2017-01-19 22:30","-26.436"],
["2017-01-19 22:31","-26.267"],
["2017-01-19 22:32","-26.23"],
["2017-01-19 22:33","-26.33"],
["2017-01-19 22:34","-26.278"],
["2017-01-19 22:35","-26.126"],
["2017-01-19 22:36","-26.023"],
["2017-01-19 22:37","-25.972"],
["2017-01-19 22:38","-25.786"],
["2017-01-19 22:39","-25.926"],
["2017-01-19 22:40","-25.989"],
["2017-01-19 22:41","-26.134"],
["2017-01-19 22:42","-26.085"],
["2017-01-19 22:43","-26.041"],
["2017-01-19 22:44","-26.037"],
["2017-01-19 22:45","-25.942"],
["2017-01-19 22:46","-25.83"],
["2017-01-19 22:47","-25.843"],
["2017-01-19 22:48","-25.931"],
["2017-01-19 22:49","-25.941"],
["2017-01-19 22:50","-25.95"],
["2017-01-19 22:51","-25.978"],
["2017-01-19 22:52","-25.886"],
["2017-01-19 22:53","-25.579"],
["2017-01-19 22:54","-25.805"],
["2017-01-19 22:55","-25.78"],
["2017-01-19 22:56","-25.698"],
["2017-01-19 22:57","-25.703"],
["2017-01-19 22:58","-25.748"],
["2017-01-19 22:59","-25.771"],
["2017-01-19 23:00","-25.771"],
["2017-01-19 23:01","-25.684"],
["2017-01-19 23:02","-25.693"],
["2017-01-19 23:03","-25.646"],
["2017-01-19 23:04","-25.429"],
["2017-01-19 23:05","-25.293"],
["2017-01-19 23:06","-25.416"],
["2017-01-19 23:07","-25.391"],
["2017-01-19 23:08","-25.28"],
["2017-01-19 23:09","-25.131"],
["2017-01-19 23:10","-25.138"],
["2017-01-19 23:11","-25.152"],
["2017-01-19 23:12","-24.914"],
["2017-01-19 23:13","-24.829"],
["2017-01-19 23:14","-24.695"],
["2017-01-19 23:15","-24.594"],
["2017-01-19 23:16","-24.452"],
["2017-01-19 23:17","-24.215"],
["2017-01-19 23:18","-24.618"],
["2017-01-19 23:19","-24.695"],
["2017-01-19 23:20","-24.571"],
["2017-01-19 23:21","-24.225"],
["2017-01-19 23:22","-23.99"],
["2017-01-19 23:23","-24.15"],
["2017-01-19 23:24","-24.527"],
["2017-01-19 23:25","-24.55"],
["2017-01-19 23:26","-24.515"],
["2017-01-19 23:27","-24.522"],
["2017-01-19 23:28","-24.449"],
["2017-01-19 23:29","-24.438"],
["2017-01-19 23:30","-24.539"],
["2017-01-19 23:31","-24.551"],
["2017-01-19 23:32","-24.438"],
["2017-01-19 23:33","-24.276"],
["2017-01-19 23:34","-24.227"],
["2017-01-19 23:35","-24.458"],
["2017-01-19 23:36","-24.507"],
["2017-01-19 23:37","-24.167"],
["2017-01-19 23:38","-23.864"],
["2017-01-19 23:39","-23.853"],
["2017-01-19 23:40","-23.848"],
["2017-01-19 23:41","-24.008"],
["2017-01-19 23:42","-24.157"],
["2017-01-19 23:43","-24.18"],
["2017-01-19 23:44","-24.095"],
["2017-01-19 23:45","-24.162"],
["2017-01-19 23:46","-24.091"],
["2017-01-19 23:47","-24.3"],
["2017-01-19 23:48","-24.449"],
["2017-01-19 23:49","-24.43"],
["2017-01-19 23:50","-24.32"],
["2017-01-19 23:51","-24.229"],
["2017-01-19 23:52","-24.349"],
["2017-01-19 23:53","-24.182"],
["2017-01-19 23:54","-24.118"],
["2017-01-19 23:55","-24.081"],
["2017-01-19 23:56","-24.327"],
["2017-01-19 23:57","-24.473"],
["2017-01-19 23:58","-24.643"],
["2017-01-19 23:59","-24.63"],
["2017-01-20 00:00","-24.534"],
["2017-01-20 00:01","-24.412"],
["2017-01-20 00:02","-24.15"],
["2017-01-20 00:03","-24.16"],
["2017-01-20 00:04","-24.158"],
["2017-01-20 00:05","-24.2"],
["2017-01-20 00:06","-24.132"],
["2017-01-20 00:07","-23.892"],
["2017-01-20 00:08","-23.603"],
["2017-01-20 00:09","-23.611"],
["2017-01-20 00:10","-23.692"],
["2017-01-20 00:11","-23.296"],
["2017-01-20 00:12","-23.283"],
["2017-01-20 00:13","-23.709"],
["2017-01-20 00:14","-23.574"],
["2017-01-20 00:15","-23.402"],
["2017-01-20 00:16","-23.06"],
["2017-01-20 00:17","-22.782"],
["2017-01-20 00:18","-22.578"],
["2017-01-20 00:19","-22.562"],
["2017-01-20 00:20","-22.579"],
["2017-01-20 00:21","-22.522"],
["2017-01-20 00:22","-22.418"],
["2017-01-20 00:23","-22.377"],
["2017-01-20 00:24","-22.252"],
["2017-01-20 00:25","-22.13"],
["2017-01-20 00:26","-22.041"],
["2017-01-20 00:27","-21.967"],
["2017-01-20 00:28","-21.787"],
["2017-01-20 00:29","-21.619"],
["2017-01-20 00:30","-21.396"],
["2017-01-20 00:31","-21.341"],
["2017-01-20 00:32","-21.283"],
["2017-01-20 00:33","-21.172"],
["2017-01-20 00:34","-21.075"],
["2017-01-20 00:35","-20.918"],
["2017-01-20 00:36","-20.826"],
["2017-01-20 00:37","-20.638"],
["2017-01-20 00:38","-20.578"],
["2017-01-20 00:39","-20.538"],
["2017-01-20 00:40","-20.492"],
["2017-01-20 00:41","-20.153"],
["2017-01-20 00:42","-20.034"],
["2017-01-20 00:43","-19.886"],
["2017-01-20 00:44","-19.959"],
["2017-01-20 00:45","-20.053"],
["2017-01-20 00:46","-19.95"],
["2017-01-20 00:47","-19.847"],
["2017-01-20 00:48","-19.914"],
["2017-01-20 00:49","-19.83"],
["2017-01-20 00:50","-19.772"],
["2017-01-20 00:51","-19.691"],
["2017-01-20 00:52","-19.624"],
["2017-01-20 00:53","-19.461"],
["2017-01-20 00:54","-19.338"],
["2017-01-20 00:55","-19.217"],
["2017-01-20 00:56","-19.195"],
["2017-01-20 00:57","-19.051"],
["2017-01-20 00:58","-18.848"],
["2017-01-20 00:59","-18.677"],
["2017-01-20 01:00","-18.664"],
["2017-01-20 01:01","-18.581"],
["2017-01-20 01:02","-18.539"],
["2017-01-20 01:03","-18.487"],
["2017-01-20 01:04","-18.387"],
["2017-01-20 01:05","-17.894"],
["2017-01-20 01:06","-17.677"],
["2017-01-20 01:07","-17.542"],
["2017-01-20 01:08","-17.412"],
["2017-01-20 01:09","-17.602"],
["2017-01-20 01:10","-17.853"],
["2017-01-20 01:11","-17.687"],
["2017-01-20 01:12","-17.581"],
["2017-01-20 01:13","-17.547"],
["2017-01-20 01:14","-17.372"],
["2017-01-20 01:15","-17.198"],
["2017-01-20 01:16","-16.864"],
["2017-01-20 01:17","-16.46"],
["2017-01-20 01:18","-15.913"],
["2017-01-20 01:19","-15.263"],
["2017-01-20 01:20","-14.657"],
["2017-01-20 01:21","-14.313"],
["2017-01-20 01:22","-13.226"],
["2017-01-20 01:23","-12.216"],
["2017-01-20 01:24","-11.239"],
["2017-01-20 01:25","-10.926"],
["2017-01-20 01:26","-10.87"],
["2017-01-20 01:27","-10.756"],
["2017-01-20 01:28","-10.63"],
["2017-01-20 01:29","-10.509"],
["2017-01-20 01:30","-10.34"],
["2017-01-20 01:31","-10.263"],
["2017-01-20 01:32","-10.272"],
["2017-01-20 01:33","-10.318"],
["2017-01-20 01:34","-10.425"],
["2017-01-20 01:35","-10.3"],
["2017-01-20 01:36","-10.528"],
["2017-01-20 01:37","-10.96"],
["2017-01-20 01:38","-10.971"],
["2017-01-20 01:39","-10.763"],
["2017-01-20 01:40","-10.801"],
["2017-01-20 01:41","-10.74"],
["2017-01-20 01:42","-10.758"],
["2017-01-20 01:43","-10.858"],
["2017-01-20 01:44","-10.924"],
["2017-01-20 01:45","-10.922"],
["2017-01-20 01:46","-11.278"],
["2017-01-20 01:47","-11.51"],
["2017-01-20 01:48","-11.645"],
["2017-01-20 01:49","-11.503"],
["2017-01-20 01:50","-11.538"],
["2017-01-20 01:51","-11.465"],
["2017-01-20 01:52","-11.554"],
["2017-01-20 01:53","-11.57"],
["2017-01-20 01:54","-11.552"],
["2017-01-20 01:55","-11.487"],
["2017-01-20 01:56","-11.339"],
["2017-01-20 01:57","-11.28"],
["2017-01-20 01:58","-11.126"],
["2017-01-20 01:59","-11.01"],
["2017-01-20 02:00","-10.86"],
["2017-01-20 02:01","-10.752"],
["2017-01-20 02:02","-10.662"],
["2017-01-20 02:03","-10.552"],
["2017-01-20 02:04","-10.35"],
["2017-01-20 02:05","-10.297"],
["2017-01-20 02:06","-10.312"],
["2017-01-20 02:07","-10.27"],
["2017-01-20 02:08","-10.325"],
["2017-01-20 02:09","-10.26"],
["2017-01-20 02:10","-10.298"],
["2017-01-20 02:11","-10.233"],
["2017-01-20 02:12","-10.168"],
["2017-01-20 02:13","-10.179"],
["2017-01-20 02:14","-10.135"],
["2017-01-20 02:15","-10.102"],
["2017-01-20 02:16","-10.071"],
["2017-01-20 02:17","-10.108"],
["2017-01-20 02:18","-10.081"],
["2017-01-20 02:19","-10.025"],
["2017-01-20 02:20","-10.001"],
["2017-01-20 02:21","-9.94"],
["2017-01-20 02:22","-9.7169"],
["2017-01-20 02:23","-9.5496"],
["2017-01-20 02:24","-9.3892"],
["2017-01-20 02:25","-9.32"],
["2017-01-20 02:26","-9.1892"],
["2017-01-20 02:27","-9.1358"],
["2017-01-20 02:28","-9.0208"],
["2017-01-20 02:29","-8.8515"],
["2017-01-20 02:30","-8.7738"],
["2017-01-20 02:31","-8.7865"],
["2017-01-20 02:32","-8.718"],
["2017-01-20 02:33","-8.6004"],
["2017-01-20 02:34","-8.6904"],
["2017-01-20 02:35","-8.7169"],
["2017-01-20 02:36","-8.6772"],
["2017-01-20 02:37","-8.7815"],
["2017-01-20 02:38","-8.77"],
["2017-01-20 02:39","-8.5031"],
["2017-01-20 02:40","-8.3912"],
["2017-01-20 02:41","-8.4788"],
["2017-01-20 02:42","-8.6015"],
["2017-01-20 02:43","-8.6435"],
["2017-01-20 02:44","-8.514"],
["2017-01-20 02:45","-8.4227"],
["2017-01-20 02:46","-8.5077"],
["2017-01-20 02:47","-8.4981"],
["2017-01-20 02:48","-8.6092"],
["2017-01-20 02:49","-8.6115"],
["2017-01-20 02:50","-8.4885"],
["2017-01-20 02:51","-8.4342"],
["2017-01-20 02:52","-8.2696"],
["2017-01-20 02:53","-8.0684"],
["2017-01-20 02:54","-8.0023"],
["2017-01-20 02:55","-7.8304"],
["2017-01-20 02:56","-7.8"],
["2017-01-20 02:57","-8.0388"],
["2017-01-20 02:58","-8.2362"],
["2017-01-20 02:59","-8.2185"],
["2017-01-20 03:00","-8.2812"],
["2017-01-20 03:01","-8.3176"],
["2017-01-20 03:02","-8.5988"],
["2017-01-20 03:03","-8.8927"],
["2017-01-20 03:04","-8.8969"],
["2017-01-20 03:05","-8.9988"],
["2017-01-20 03:06","-9.2269"],
["2017-01-20 03:07","-9.195"],
["2017-01-20 03:08","-9.1354"],
["2017-01-20 03:09","-8.9528"],
["2017-01-20 03:10","-8.7038"],
["2017-01-20 03:11","-8.5219"],
["2017-01-20 03:12","-8.5342"],
["2017-01-20 03:13","-8.642"],
["2017-01-20 03:14","-8.4869"],
["2017-01-20 03:15","-8.3892"],
["2017-01-20 03:16","-8.3073"],
["2017-01-20 03:17","-8.3728"],
["2017-01-20 03:18","-8.3508"],
["2017-01-20 03:19","-8.2615"],
["2017-01-20 03:20","-8.1177"],
["2017-01-20 03:21","-7.798"],
["2017-01-20 03:22","-7.5731"],
["2017-01-20 03:23","-7.4273"],
["2017-01-20 03:24","-7.1948"],
["2017-01-20 03:25","-7.07"],
["2017-01-20 03:26","-6.7212"],
["2017-01-20 03:27","-6.3208"],
["2017-01-20 03:28","-5.9936"],
["2017-01-20 03:29","-5.8527"],
["2017-01-20 03:30","-5.6619"],
["2017-01-20 03:31","-5.3458"],
["2017-01-20 03:32","-5.0784"],
["2017-01-20 03:33","-5.0638"],
["2017-01-20 03:34","-4.9873"],
["2017-01-20 03:35","-4.85"],
["2017-01-20 03:36","-4.7388"],
["2017-01-20 03:37","-4.6781"],
["2017-01-20 03:38","-4.5154"],
["2017-01-20 03:39","-4.4312"],
["2017-01-20 03:40","-4.2973"],
["2017-01-20 03:41","-4.1862"],
["2017-01-20 03:42","-4.1888"],
["2017-01-20 03:43","-4.2144"],
["2017-01-20 03:44","-4.2458"],
["2017-01-20 03:45","-4.2673"],
["2017-01-20 03:46","-4.1664"],
["2017-01-20 03:47","-4.1077"],
["2017-01-20 03:48","-4.1177"],
["2017-01-20 03:49","-4.0915"],
["2017-01-20 03:50","-4.1344"],
["2017-01-20 03:51","-4.2485"],
["2017-01-20 03:52","-4.2181"],
["2017-01-20 03:53","-4.18"],
["2017-01-20 03:54","-4.1384"],
["2017-01-20 03:55","-4.0754"],
["2017-01-20 03:56","-4.0062"],
["2017-01-20 03:57","-3.9468"],
["2017-01-20 03:58","-4.0362"],
["2017-01-20 03:59","-4.0531"],
["2017-01-20 04:00","-4.1077"],
["2017-01-20 04:01","-4.16"],
["2017-01-20 04:02","-4.1154"],
["2017-01-20 04:03","-3.9304"],
["2017-01-20 04:04","-3.8342"],
["2017-01-20 04:05","-3.8873"],
["2017-01-20 04:06","-3.9592"],
["2017-01-20 04:07","-3.8931"],
["2017-01-20 04:08","-3.8551"],
["2017-01-20 04:09","-3.8001"],
["2017-01-20 04:10","-3.8577"],
["2017-01-20 04:11","-3.8773"],
["2017-01-20 04:12","-3.9385"],
["2017-01-20 04:13","-4.0027"],
["2017-01-20 04:14","-3.9196"],
["2017-01-20 04:15","-3.9326"],
["2017-01-20 04:16","-3.8938"],
["2017-01-20 04:17","-3.7246"],
["2017-01-20 04:18","-3.54"],
["2017-01-20 04:19","-3.5312"],
["2017-01-20 04:20","-3.5708"],
["2017-01-20 04:21","-3.4794"],
["2017-01-20 04:22","-3.289"],
["2017-01-20 04:23","-3.2138"],
["2017-01-20 04:24","-3.2347"],
["2017-01-20 04:25","-3.3043"],
["2017-01-20 04:26","-3.1978"],
["2017-01-20 04:27","-3.2502"],
["2017-01-20 04:28","-3.2207"],
["2017-01-20 04:29","-3.1775"],
["2017-01-20 04:30","-3.1708"],
["2017-01-20 04:31","-3.1107"],
["2017-01-20 04:32","-3.0668"],
["2017-01-20 04:33","-3.0622"],
["2017-01-20 04:34","-3.507"],
["2017-01-20 04:35","-3.5735"],
["2017-01-20 04:36","-3.6447"],
["2017-01-20 04:37","-3.7212"],
["2017-01-20 04:38","-3.6881"],
["2017-01-20 04:39","-3.7159"],
["2017-01-20 04:40","-3.5777"],
["2017-01-20 04:41","-3.4281"],
["2017-01-20 04:42","-3.3633"],
["2017-01-20 04:43","-3.1601"],
["2017-01-20 04:44","-3.1902"],
["2017-01-20 04:45","-3.1258"],
["2017-01-20 04:46","-2.9929"],
["2017-01-20 04:47","-2.8774"],
["2017-01-20 04:48","-2.766"],
["2017-01-20 04:49","-2.7912"],
["2017-01-20 04:50","-2.8422"],
["2017-01-20 04:51","-2.8346"],
["2017-01-20 04:52","-2.9005"],
["2017-01-20 04:53","-2.869"],
["2017-01-20 04:54","-2.8924"],
["2017-01-20 04:55","-2.9592"],
["2017-01-20 04:56","-3.1516"],
["2017-01-20 04:57","-3.3426"],
["2017-01-20 04:58","-3.4486"],
["2017-01-20 04:59","-3.5021"],
["2017-01-20 05:00","-3.6159"],
["2017-01-20 05:01","-3.5982"],
["2017-01-20 05:02","-3.5499"],
["2017-01-20 05:03","-3.5077"],
["2017-01-20 05:04","-3.4954"],
["2017-01-20 05:05","-3.5317"],
["2017-01-20 05:06","-3.5103"],
["2017-01-20 05:07","-3.4766"],
["2017-01-20 05:08","-3.4789"],
["2017-01-20 05:09","-3.4838"],
["2017-01-20 05:10","-3.3615"],
["2017-01-20 05:11","-3.3511"],
["2017-01-20 05:12","-3.2683"],
["2017-01-20 05:13","-3.3882"],
["2017-01-20 05:14","-3.359"],
["2017-01-20 05:15","-3.2123"],
["2017-01-20 05:16","-3.2059"],
["2017-01-20 05:17","-3.1868"],
["2017-01-20 05:18","-3.1818"],
["2017-01-20 05:19","-3.2016"],
["2017-01-20 05:20","-3.0129"],
["2017-01-20 05:21","-3.0584"],
["2017-01-20 05:22","-3.0219"],
["2017-01-20 05:23","-3.0557"],
["2017-01-20 05:24","-3.0385"],
["2017-01-20 05:25","-3.0535"],
["2017-01-20 05:26","-3.0907"],
["2017-01-20 05:27","-3.0418"],
["2017-01-20 05:28","-2.9863"],
["2017-01-20 05:29","-3.0175"],
["2017-01-20 05:30","-3.068"],
["2017-01-20 05:31","-3.1771"],
["2017-01-20 05:32","-3.2949"],
["2017-01-20 05:33","-3.2312"],
["2017-01-20 05:34","-3.0178"],
["2017-01-20 05:35","-2.8989"],
["2017-01-20 05:36","-2.7609"],
["2017-01-20 05:37","-2.6178"],
["2017-01-20 05:38","-2.6216"],
["2017-01-20 05:39","-2.6698"],
["2017-01-20 05:40","-2.65"],
["2017-01-20 05:41","-2.6533"],
["2017-01-20 05:42","-2.6274"],
["2017-01-20 05:43","-2.651"],
["2017-01-20 05:44","-2.8379"],
["2017-01-20 05:45","-2.9598"],
["2017-01-20 05:46","-2.9628"],
["2017-01-20 05:47","-2.9528"],
["2017-01-20 05:48","-2.9034"],
["2017-01-20 05:49","-2.864"],
["2017-01-20 05:50","-2.7431"],
["2017-01-20 05:51","-3.1522"],
["2017-01-20 05:52","-2.8754"],
["2017-01-20 05:53","-2.692"],
["2017-01-20 05:54","-2.6534"],
["2017-01-20 05:55","-2.6353"],
["2017-01-20 05:56","-2.6636"],
["2017-01-20 05:57","-2.7043"],
["2017-01-20 05:58","-2.7424"],
["2017-01-20 05:59","-2.7572"],
["2017-01-20 06:00","-2.7185"],
["2017-01-20 06:01","-2.6649"],
["2017-01-20 06:02","-2.641"],
["2017-01-20 06:03","-2.5246"],
["2017-01-20 06:04","-2.4577"],
["2017-01-20 06:05","-2.4136"],
["2017-01-20 06:06","-2.4175"],
["2017-01-20 06:07","-2.4887"],
["2017-01-20 06:08","-2.5735"],
["2017-01-20 06:09","-2.7103"],
["2017-01-20 06:10","-2.7824"],
["2017-01-20 06:11","-2.7633"],
["2017-01-20 06:12","-2.6852"],
["2017-01-20 06:13","-2.6742"],
["2017-01-20 06:14","-2.6981"],
["2017-01-20 06:15","-2.755"],
["2017-01-20 06:16","-2.7216"],
["2017-01-20 06:17","-2.6974"],
["2017-01-20 06:18","-2.6708"],
["2017-01-20 06:19","-2.6926"],
["2017-01-20 06:20","-2.7509"],
["2017-01-20 06:21","-2.7164"],
["2017-01-20 06:22","-2.5979"],
["2017-01-20 06:23","-2.4628"],
["2017-01-20 06:24","-2.3739"],
["2017-01-20 06:25","-2.4023"],
["2017-01-20 06:26","-2.505"],
["2017-01-20 06:27","-2.4079"],
["2017-01-20 06:28","-2.4042"],
["2017-01-20 06:29","-2.3667"],
["2017-01-20 06:30","-2.3784"],
["2017-01-20 06:31","-2.4197"],
["2017-01-20 06:32","-2.4132"],
["2017-01-20 06:33","-2.4432"],
["2017-01-20 06:34","-2.4716"],
["2017-01-20 06:35","-2.5313"],
["2017-01-20 06:36","-2.6563"],
["2017-01-20 06:37","-2.6765"],
["2017-01-20 06:38","-2.6669"],
["2017-01-20 06:39","-2.6607"],
["2017-01-20 06:40","-2.7219"],
["2017-01-20 06:41","-2.8202"],
["2017-01-20 06:42","-2.8668"],
["2017-01-20 06:43","-2.9301"],
["2017-01-20 06:44","-3.0169"],
["2017-01-20 06:45","-3.1062"],
["2017-01-20 06:46","-3.1475"],
["2017-01-20 06:47","-3.1931"],
["2017-01-20 06:48","-3.0737"],
["2017-01-20 06:49","-2.8711"],
["2017-01-20 06:50","-3.162"],
["2017-01-20 06:51","-3.1288"],
["2017-01-20 06:52","-3.1999"],
["2017-01-20 06:53","-3.2555"],
["2017-01-20 06:54","-3.2884"],
["2017-01-20 06:55","-3.3286"],
["2017-01-20 06:56","-3.157"],
["2017-01-20 06:57","-3.4488"],
["2017-01-20 06:58","-3.4066"],
["2017-01-20 06:59","-3.1032"],
["2017-01-20 07:00","-3.1484"],
["2017-01-20 07:01","-3.1018"],
["2017-01-20 07:02","-3.0487"],
["2017-01-20 07:03","-3.3709"],
["2017-01-20 07:04","-3.041"],
["2017-01-20 07:05","-2.9618"],
["2017-01-20 07:06","-2.8398"],
["2017-01-20 07:07","-2.5849"],
["2017-01-20 07:08","-2.5254"],
["2017-01-20 07:09","-2.2742"],
["2017-01-20 07:10","-1.6868"],
["2017-01-20 07:11","-1.7618"],
["2017-01-20 07:12","-1.9917"],
["2017-01-20 07:13","-1.7749"],
["2017-01-20 07:14","-1.8449"]
]


import math
from decimal import Decimal, getcontext
from datetime import datetime
from time import mktime

# #################################################################################
# bindata will take an array, each element is (unixtime, datavalue). It will parse
# thru the array and provide the average datavalue for the bin, provided there are enough
# datavalues per bin. the function returns the binned data, most recent at the front/top.
# If there are gaps or insufficiencies in data, there will be blanks
def bindata(rawdata, binsizeseconds, mincount):
    # init the return array
    bins = []

    # reverse the raw data so most recent is at the top
    rawdata.reverse()

    # Find the begin and end times for the data
    nowsplit = rawdata[0].split(",")
    nowtime = nowsplit[0]
    startsplit = rawdata[len(rawdata) - 1].split(",")
    starttime = startsplit[0]

    # populate bins with the required timeslots
    for i in range(int(float(nowtime)), int(float(starttime)), -1 * binsizeseconds):
        bins.append(i)

    # We need to check thru the rawdata to find data that will fit in the required bin values
    returnarray = []
    for item in bins:
        pass

    return returnarray


# #################################################################################
# Calculate the differences
# This function will create an array of differences. each element is (unixtime, datavalue)
# Big gaps in time will cause either a BIG jump in datavalues (which will get filtered out)
# or small gaps, which if the  trend os flat, are to be expected. so should not add
# significant error.
# #################################################################################
def create_diffs(readings):
    diffsarray = []
    # This is a value for spikes that are false, or artificially caused
    NOISE_SPIKE = 3

    # If the array is of sufficient size...
    if len(readings) > 2:
        for i in range(1, len(readings)):
            # get the 2 data readings we need to calculate the differences
            nowdata = readings[i]
            nowdata = nowdata.split(",")
            datetime = nowdata[0]
            data_now = nowdata[1]

            olddata = readings[i - 1]
            olddata = olddata.split(",")
            data_old = olddata[1]

            # Calculate the difference figure we need
            diffdata = float(data_now) - float(data_old)

            # if the difference is abnormally large, then make it a zero.
            if math.sqrt(math.pow(diffdata, 2)) > NOISE_SPIKE:
                diffdata = 0

            dp = str(datetime) + "," + str(diffdata)

            diffsarray.append(dp)

    else:
        dp = ("0000-00-00 00:00:00", 0)
        diffsarray.append(dp)

    return diffsarray


# ##################################################
# Convert timestamps in array to Unix time
# ##################################################
def utc2unix(arraylist):
    print("Converting time to UNIX time...")
    # set date time format for strptime()
    # dateformat = "%Y-%m-%d %H:%M:%S.%f"
    dateformat = "%Y-%m-%d %H:%M"
    workingarray = []

    # convert array data times to unix time
    workingarray = []
    for item in arraylist:
        try:
            newdatetime = datetime.strptime(item[0],dateformat)
            # convert to Unix time (Seconds)
            newdatetime = mktime(newdatetime.timetuple())

            datastring = str(newdatetime) + "," + str(item[1])
            workingarray.append(datastring)
        except:
            print("Problem with this entry: " + str(item))

    return workingarray


testdata = utc2unix(testdata)
testdata = create_diffs(testdata)
bindata(testdata,3600, 100)
